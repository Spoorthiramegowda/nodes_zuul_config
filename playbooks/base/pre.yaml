---
- hosts: all
  tasks:
    - name: Set Ansible SSH configuration for static node
      set_fact:
        ansible_ssh_private_key_file: /var/ssh/nodepool
        ansible_user: minson
        ansible_ssh_common_args: -o StrictHostKeyChecking=no

    - name: Test SSH connection
      ping:

    - name: Create zuul workspace
      file:
        path: "{{ zuul.project.src_dir }}"
        state: directory
        mode: 0755

    - name: Ensure workspace is writable
      file:
        path: "{{ zuul.project.src_dir }}"
        owner: "{{ zuul.executor.user | default('root') }}"
        group: "{{ zuul.executor.user | default('root') }}"
        recurse: yes

    - name: Display connection info
      debug:
        msg: |
          âœ… Connected to node: {{ inventory_hostname }}
          Using SSH key: /var/ssh/nodepool
          Workspace: {{ zuul.project.src_dir }}
